package torque.generated;


import java.io.IOException;
import java.util.Iterator;
import java.util.List;

import org.apache.torque.Torque;
import org.apache.torque.TorqueException;
import org.apache.torque.oid.SequenceIdGenerator;
import org.apache.torque.om.Persistent;

import com.workingdogs.village.DataSetException;
import com.workingdogs.village.Record;

import trolls.MoteurGraphique;

/**
 * Troll_s_
 *
 * The skeleton for this class was autogenerated by Torque on:
 *
 * [Mon Mar 16 11:37:00 CET 2009]
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 */
public  class Troll
    extends torque.generated.BaseTroll
    implements Persistent
{
    /** Serial version */
    private static final long serialVersionUID = 1237199820151L;
    
    public void init(MoteurGraphique IG) {
    	
    	try {
	    	
	        String nom = IG.question("Nom du troll:");
	        this.setNom(nom);
	        		
			while ((this.getAttaque()+this.getDegats()+this.getEsquive()+this.getVie()) != 40){
				IG.afficher("Affectation des points de " + this.getNom());
				this.setAttaque(IG.questionInt("Nombre de points d'attaque : "));
				this.setDegats(IG.questionInt("Nombre de points de dégâts : "));
				this.setEsquive(IG.questionInt("Nombre de points d'esquive : "));
				this.setVie(IG.questionInt("Nombre de points de vie : "));
				
				this.save();
				
				System.out.println(this.getAttaque()+this.getDegats()+this.getEsquive()+this.getVie());
			}
			
		} catch (TorqueException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		}
    }
    
    public void update() throws TorqueException, DataSetException {
		String SQL = "select * from troll where nom = '"+this.getNom()+"'";
		List records = TrollPeer.executeQuery(SQL);
		
		for (Iterator i = records.iterator(); i.hasNext();) {
		    Record record = (Record) i.next();
//		     nom | attaque | degats | vie | esquive | pa | x | y | id_equip_arme | id_equip_protect 
		    int nx = record.getValue("x").asInt();
		    int ny = record.getValue("y").asInt();
		    int natt = record.getValue("attaque").asInt();
		    int nesq = record.getValue("esquive").asInt();
		    int ndeg = record.getValue("degats").asInt();
		    int nvie = record.getValue("vie").asInt();
		    int npa = record.getValue("pa").asInt();
		    int nIdEqAr = record.getValue("id_equip_arme").asInt();
		    int nIdEqPr = record.getValue("id_equip_protect").asInt();
			this.setX(nx);
			this.setY(ny);
			this.setAttaque(natt);
			this.setEsquive(nesq);
			this.setDegats(ndeg);
			this.setVie(nvie);
			this.setPa(npa);
			this.setIdEquipArme(nIdEqAr);
			this.setIdEquipProtect(nIdEqPr);
		}
		TrollPeer.doUpdate(this);
	}
}
